<!DOCTYPE HTML>

<html charset="utf-8" encoding="utf-8" lang="zh-CN" language="Chinese" prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta name="language" content="Chinese">
        <title>
            Poetry 与 Python
        </title>
        <meta name="author" content="Nasy">
        <meta name="owner" content="Nasy">
        <meta name="copyright" content="© 2019 Nasy">
        <meta name="og:site_name" content="Nasy Land">
        <meta name="og:title" content="Poetry 与 Python">
        <meta name="og:url" content="https://nasy.moe">
        <meta name="og:description" content="Nasy 的花园，栽花养鱼闲聊的地方～">
        <meta name="og:image" content="https://nasy.moe/images/icon.png">
        <meta name="og:type" content="blog">
        <meta name="viewport" content="height=device-height,width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,minimal-ui">
        <meta name="HandleFriendly" content="True">
        <meta name="MSThemeCompatible" content="no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="translucent black">
        <meta name="msapplication-navbutton-color" content="translucent black">
        <meta name="mssmarttagspreventparsing" content="true">
        <meta name="theme-color" content="#ffeab6">
        <meta http-equiv="Cache-Control" content="public,max-age=1800,max-stale,stale-while-revalidate=86400,stale-if-error=259200" rem="max-age=30minutes">
        <meta http-equiv="Page-Enter" content="RevealTrans(Duration=1.0,Transition=1)">
        <meta http-equiv="Page-Exit" content="RevealTrans(Duration=1.0,Transition=1)">
        <link rel="stylesheet" href="../../styles/main.css" type="text/css" media="screen">
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-102577027-1">
            
        </script>
        <script>
            window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-102577027-1');
        </script>
        <script src="//instant.page/1.2.2" type="module" Integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU">
            
        </script>
    </head>
    <body>
        <header id="header" class="header">
            <h1>
                <a title="home" href="../../">
                    Nasy Land
                </a>
            </h1>
            <nav class="nasy-links">
                <ul>
                    <li class>
                        <a href="../../" title="home">
                            Home
                        </a>
                    </li>
                    <li class>
                        <a href="../../about#About" title="about">
                            About
                        </a>
                    </li>
                    <li class>
                        <a href="../../tags" title="tags">
                            Tags
                        </a>
                    </li>
                    <li class>
                        <a href="https://emacs.nasy.moe" title="emacs configuration">
                            Emacs Configuration
                        </a>
                    </li>
                    <li class="header-hide">
                        <a href="mailto:nasyxx+nasymoe@gmail.com" title="email me">
                            Email Me
                        </a>
                    </li>
                    <li class="header-hide">
                        <a href="../../atom.xml" title="atom feed">
                            Atom Feed
                        </a>
                    </li>
                    <li class="header-hide">
                        <a href="../../rss.xml" title="rss feed">
                            RSS Feed
                        </a>
                    </li>
                </ul>
            </nav>
        </header>
        <main id="main" class="main">
            <article class="blog">
    <header class="blog-header">
        <h2 class="center-title">
            Poetry 与 Python
        </h2>
        <section class="metas">
            
            <section class="author hide">
                <p>
                    Nasy
                </p>
            </section>
            
            
            <section class="date">
                <p>
                    August 15, 2018
                </p>
            </section>
            
            
            <section class="summary">
                <p>
                    好用的 Python 依赖管理以及打包工具 Poetry.
                </p>
            </section>
            
            
            <section class="meta tags">
                <ul>
                    <li class="tags-li"><a href="../../tags/%E8%8D%89/">#草</a></li><li class="tags-li"><a href="../../tags/kusa/">#kusa</a></li><li class="tags-li"><a href="../../tags/%F0%9F%8D%80/">#🍀</a></li><li class="tags-li"><a href="../../tags/tools/">#tools</a></li><li class="tags-li"><a href="../../tags/open-source/">#open-source</a></li>
                </ul>
            </section>
            
        </section>
    </header>
    <section class="blog-section">
        <h1 id="poetry-是什么">Poetry 是什么？</h1>
<p>Poetry: <a href="https://poetry.eustace.io">https://poetry.eustace.io</a></p>
<p>Poetry 是一个 Python 的依赖管理以及打包工具。 用他官方的话说就是：</p>
<blockquote>
<p>Poetry is a tool for dependency management and packaging in Python. It allows you to declare the libraries your project depends on and it will manage (install/update) them for you.</p>
</blockquote>
<h1 id="遇见">遇见</h1>
<p>对于 Python 来说，虚拟环境一直有很多选择，无论是直接使用自带的 <code>virtualenv</code> ，还是通过 <code>pyenv</code> 使用 <code>virtualenv</code> ，我都觉得，用起来很不爽。原因有两个：</p>
<ul>
<li>配置麻烦</li>
<li>莫名其妙多了个文件夹</li>
<li>还多了一些文件</li>
</ul>
<p>当然，之后， <code>pipenv</code> 出世，基本把所有的内容装到了同一个文件里面。 遗憾的是，也许是乱七八糟的功能之类的太多了，我似乎用不习惯。 我所想要的是一个如同 <code>cargo</code> 或者 <code>stack</code> 那样的东西， <code>pipenv</code> 并不能很顺畅的达到这样的需求，该写 <code>makefile</code> 还是要写。</p>
<p>在一次日常浏览 GitHub Trending 的时候，我发现了 <code>Poetry</code>, 这个超棒的工具。</p>
<h1 id="如诗一般地使用">如诗一般地使用</h1>
<p>一直以来，如果是我个人使用，我都是不用任何虚拟环境的，一是麻烦，二是觉得没必要。 直到有一个有一个该死的库 <code>prompt-toolkit</code> 2.x 版本与 1.x 版本不兼容，而且一些经常使用的包还经常用它。 没错，说的就是 <code>ipython</code> 。 才让我开始注意虚拟环境，并且在一些时候使用它。 事实上，就算是 Haskell，我也是不怎么使用 local 环境下的 <code>ghci</code> 毕竟，没有高亮，没有很多乱七八糟的东西，看起来太不舒服了。 在认识 <code>Poetry</code> 之前，我一直是直接使用 <code>virtualenv</code> 或者 <code>pipenv</code> 。 很惭愧，因为没做过什么特别大的项目，我几乎不需要把环境隔离。</p>
<p><code>Poetry</code> 在各个方面都太方便了，比如说，他使用 <code>pyproject.toml</code> 这样的配置文件，而非其他的那些很多乱七八糟的。 另一方面，它提供了诸如 <code>new</code>, <code>publish</code>, <code>build</code>, <code>run</code> 这样的命令，可以说与 <code>stack</code> 体验一致。 最方便的是，不用再写 <code>makefile</code> 了。 你可以这样，在 <code>pyproject.toml</code> 里面写上:</p>
<pre class="toml"><code>[tool.poetry.scripts]
crawl_it = &quot;crawler:main&quot;
</code></pre>
<p>然后简单的 <code>poetry run crawl_it</code> 来运行，不需要费心在 <code>makefile</code> 里面写上:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode makefile"><code class="sourceCode makefile"><a class="sourceLine" id="cb2-1" title="1"><span class="dv">crawl-it:</span></a>
<a class="sourceLine" id="cb2-2" title="2">        poetry run python crawler.py</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="ot">.PHONY:</span><span class="dt"> crawl-it</span></a></code></pre></div>
<p>还有一点也很重要，有了这东西，可以保证工作文件夹干净，不会出现虚拟环境的文件夹。</p>
<hr />
<p>我自己使用 Python，最主要就是用来写爬虫。 用上 <code>Poetry</code> 之后，个人最经常的操作就是:</p>
<div class="sourceCode" id="cb3" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="fu">mkdir</span> xxxx         <span class="co"># 创建文件夹 xxxx</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="bu">cd</span> xxxx            <span class="co"># 进入</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="ex">poetry</span> init        <span class="co"># 项目初始化(会有一些选项选择)</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="ex">emacsclient</span> -c .   <span class="co"># 打开最喜欢的编辑器</span></a></code></pre></div>
    </section>
    <footer>
        <section id="comment">
            
        </section>
    </footer>
    <script src="https://unpkg.com/vue/dist/vue.runtime.min.js">
        
    </script>
    <link rel="stylesheet" href="https://unpkg.com/vssue/dist/vssue.min.css" type="text/css" media="screen">
    <script src="https://unpkg.com/vssue/dist/vssue.github.min.js">
        
    </script>
    <script>
        
const comment = "Poetry 与 Python"


const ctitle = "Poetry 与 Python"

new Vue({
  el: '#comment',
  render: h => h('Vssue', {
    props: {
      title: ctitle,      options: {
        state: "Nasy",
        labels: ["comment", comment],
        prefix: "",
        owner: "nasyxx",
        repo: "comments",
        clientId: "cb5605d5ea28ce5ba8d2",
        clientSecret: "942e0d9f31ea8d7d30845fa26bc51ed6551153d8",
        autoCreateIssue: false,
        issueContent: url => "Comment of: \n" + document.URL,
      },
    }
  })
})
    </script>
</article>

        </main>
        <footer id="footer" class="footer">
            <header data-aos="zoom-out-up" data-aos-duration="400" data-aos-anchor-placement="top-bottom">
                <nav class="nasy-links">
                    <ul>
                        <li class>
                            <a href="../../" title="home">
                                Home
                            </a>
                        </li>
                        <li class>
                            <a href="../../about#About" title="about">
                                About
                            </a>
                        </li>
                        <li class>
                            <a href="../../tags" title="tags">
                                Tags
                            </a>
                        </li>
                        <li class>
                            <a href="https://emacs.nasy.moe" title="emacs configuration">
                                Emacs Configuration
                            </a>
                        </li>
                        <li class="header-hide">
                            <a href="mailto:nasyxx+nasymoe@gmail.com" title="email me">
                                Email Me
                            </a>
                        </li>
                        <li class="header-hide">
                            <a href="../../atom.xml" title="atom feed">
                                Atom Feed
                            </a>
                        </li>
                        <li class="header-hide">
                            <a href="../../rss.xml" title="rss feed">
                                RSS Feed
                            </a>
                        </li>
                    </ul>
                </nav>
                <nav class="friend-links">
                    <ul>
                        <li>
                            <a href="https://laobubu.net" title="laobubu">
                                Laobubu
                            </a>
                        </li>
                        <li>
                            <a href="https://yuki.yuki233.com" title="初雪">
                                初雪
                            </a>
                        </li>
                        <li>
                            <a href="https://mitsuhachan.ml" title="三葉的喵窝">
                                三葉的喵窝
                            </a>
                        </li>
                        <li>
                            <a href="https://blog.zsakvo.cc" title="水水的小窝">
                                水水的小窝
                            </a>
                        </li>
                        <li>
                            <a href="https://daisuke.moe" title="白兔">
                                白兔
                            </a>
                        </li>
                    </ul>
                </nav>
            </header>
            <section id="copyright">
                <p>
                    Copyright © 2019 Nasy
                </p>
            </section>
        </footer>
        <link rel="stylesheet" href="https://unpkg.com/aos/dist/aos.css" type="text/css" media="screen">
        <script src="https://unpkg.com/aos/dist/aos.js">
            
        </script>
        <script>
            AOS.init()
        </script>
    </body>
</html>
